function Get-SecEventInfo {
<#
.SYNOPSIS
.EXAMPLE
    PrzykÅ‚ad uzycia
.DESCRIPTION
    Opis funkcji
#>  
    [CmdletBinding()]
    Param (
        [Parameter(ParameterSetName="Logs",
                    ValueFromPipeline=$true,
                    ValueFromPipelineByPropertyName=$true)]
        [Alias("Hostname")]
        [ValidateSet("LON-DC1","LON-SVR1","LON-CL1")]
        [string[]]$ComputerName = $env:COMPUTERNAME,
        [Alias("InstanceID")]
        [Parameter(ParameterSetName="Logs")]
        [int]$EventID = 4624,
        [int]$Count = 5,

        [Parameter(ParameterSetName="list")]
        [switch]$List,
        [Parameter(ParameterSetName="Clear")]
        [switch]$Clear
    )   #param
    BEGIN{}
    PROCESS{
        foreach ($item in $ComputerName) {
            try {
                Write-Verbose "Bout to conn to $item"
                Write-Host "`nConnecting to $item" -ForegroundColor Red
                Get-EventLog -Logname Security -ComputerName $item -ErrorAction Stop -ErrorVariable MyErr |
                    Where-Object EventID -eq $EventID   |
                        Select-Object -First $Count |
                            Format-Table 
                $OS = Get-WmiObject -Class Win32_OperatingSystem -ComputerName $item 
                $user = whoami
                Write-Host "------------- PODSUMOWANIE --------------"
                $summ = [ordered]@{
                    'Computer' = "$item";
                    'User'  =   $user;
                    'System'    =   $OS.caption
                    }
                $Output = net-object -TypeName PSObject -propety $summ
                Write-Output $Output
                Write-Output $log
                }   #try
                catch {
                    Write-Output $MyErr
                }   #catch
                finally{
                    Write-Host "------------------------ END"
                }   #finally
        }   #foreach
    }   #PROCESS
    END{}
}   #function

